@import url('https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&display=swap');

:root {
    --font-main: 'Manrope', sans-serif;
    --ease-elastic: cubic-bezier(0.4, 0, 0.2, 1);
}

body {
    font-family: var(--font-main);
    background: var(--bg-main);
    color: var(--text-primary);
    transition: all 0.4s var(--ease-elastic);
    overflow-x: hidden;
    font-size: 14px;
}

/* =========================================
   1. SOFT GLASS (Default Dark Neon)
   ========================================= */
[data-theme="soft-glass"] {
    --bg-main: radial-gradient(circle at 50% 50%, #05050a 0%, #000000 100%);
    --text-primary: #FFFFFF;
    --text-secondary: #94A3B8;
    
    /* Panels */
    --panel-bg: rgba(20, 20, 25, 0.7);
    --panel-border: 1px solid rgba(255, 255, 255, 0.08);
    --panel-blur: blur(20px);
    --shadow-depth: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
    
    /* Bubbles */
    --bubble-self-bg: linear-gradient(135deg, #7C3AED, #3B82F6);
    --bubble-self-text: white;
    --bubble-other-bg: rgba(30, 32, 40, 0.9);
    --bubble-other-text: #e2e8f0;
    
    /* Input */
    --cockpit-bg: rgba(20, 20, 25, 0.98);
    --input-bg: #000000;
    
    /* Accents */
    --accent-color: #a855f7;
    
    /* Menus */
    --menu-bg: #1e1e24;
    --menu-text: #cbd5e1;
    --menu-hover: rgba(255,255,255,0.1);
}

/* =========================================
   2. WHITE MATTE (3D Depth / Clean)
   ========================================= */
[data-theme="white-matte"] {
    /* Main Background (Light Grey for Contrast) */
    --bg-main: #F2F4F7; 
    
    --text-primary: #111827; /* Deep Black */
    --text-secondary: #64748B;
    
    /* Panels (Pure White + Shadow = 3D Effect) */
    --panel-bg: #FFFFFF;
    --panel-border: 1px solid transparent; /* No border, just shadow */
    --panel-blur: none;
    --shadow-depth: 0 10px 30px -5px rgba(0, 0, 0, 0.08), 0 4px 10px rgba(0,0,0,0.02);
    
    /* Bubbles */
    --bubble-self-bg: linear-gradient(135deg, #3B82F6, #2563EB);
    --bubble-self-text: white;
    --bubble-other-bg: #FFFFFF;
    --bubble-other-text: #1F2937;
    
    /* Input */
    --cockpit-bg: #FFFFFF;
    --input-bg: #F3F4F6;
    
    /* Accents */
    --accent-color: #3B82F6;
    
    /* Menus */
    --menu-bg: #FFFFFF;
    --menu-text: #374151;
    --menu-hover: #F3F4F6;
}

/* --- 3. LUXURY OS (Gold) --- */
[data-theme="oled-lux"] {
    --bg-main: #000000;
    --text-primary: #E5E5E5;
    --text-secondary: #A3A3A3;
    --panel-bg: #0A0A0A;
    --panel-border: 1px solid #333333;
    --panel-blur: none;
    --shadow-depth: 0 20px 40px rgba(0,0,0,0.5);
    --bubble-self-bg: linear-gradient(135deg, #D4AF37, #F59E0B);
    --bubble-self-text: black;
    --bubble-other-bg: #171717;
    --bubble-other-text: #D4D4D4;
    --cockpit-bg: #0A0A0A;
    --input-bg: #171717;
    --accent-color: #D4AF37;
    --menu-bg: #171717;
    --menu-text: #D4D4D4;
    --menu-hover: #262626;
}

/* =========================================
   CHAT ENGINE V14 (Fixed Clipping & Design)
   ========================================= */

.chat-container { 
    display: flex; flex-direction: column; height: 100vh; overflow: hidden; 
    background: var(--bg-main);
    padding: 12px; gap: 12px;
}

/* --- HEADER (Separated Panel) --- */
.chat-header-glass {
    flex-shrink: 0;
    padding: 12px 20px;
    background: var(--panel-bg);
    border: var(--panel-border);
    border-radius: 24px;
    backdrop-filter: var(--panel-blur);
    display: flex; align-items: center; justify-content: space-between;
    box-shadow: var(--shadow-depth); /* 3D Depth */
    z-index: 50;
    color: var(--text-primary);
}

.header-title h1 { color: var(--text-primary); font-weight: 800; font-size: 1.1rem; }
.header-title span { color: var(--text-secondary); font-size: 0.7rem; font-weight: 700; letter-spacing: 1px; }

/* --- CHAT LOG (Fixed Clipping) --- */
#chat-log { 
    flex: 1; 
    /* SUPER IMPORTANT: 160px padding pushes messages above the cockpit */
    padding-bottom: 160px !important; 
    
    background: rgba(255,255,255,0.01);
    border-radius: 24px;
    overflow-y: overlay; 
    padding: 20px;
    scroll-behavior: smooth; 
}
#chat-log::-webkit-scrollbar { width: 4px; }
#chat-log::-webkit-scrollbar-thumb { background: var(--text-secondary); border-radius: 10px; opacity: 0.3; }

/* --- BUBBLES --- */
.chat-row { display: flex; width: 100%; margin-bottom: 6px; align-items: flex-end; padding-right: 4px; position: relative; }
.chat-row.self { justify-content: flex-end; }
.chat-row.other { justify-content: flex-start; }

.chat-bubble {
    max-width: 70%; min-width: 180px; 
    padding: 10px 14px; position: relative;
    font-size: 0.9rem; line-height: 1.4; 
    display: flex; flex-direction: column; gap: 4px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
    backdrop-filter: var(--panel-blur);
    transition: all 0.2s ease;
}

.chat-bubble.self {
    background: var(--bubble-self-bg); color: var(--bubble-self-text);
    border-radius: 18px 18px 2px 18px; 
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.chat-bubble.other {
    background: var(--bubble-other-bg); color: var(--bubble-other-text);
    border-radius: 18px 18px 18px 2px;
    /* In White Mode, this will be white card on grey bg */
    box-shadow: 0 2px 10px rgba(0,0,0,0.05); 
}

/* --- WHATSAPP REPLY CARD --- */
.reply-context {
    background: rgba(0, 0, 0, 0.15); 
    border-left: 4px solid var(--accent-color);
    border-radius: 6px;
    padding: 8px 10px; margin-bottom: 6px;
    font-size: 0.75rem; cursor: pointer;
    transition: all 0.2s ease;
    display: flex; flex-direction: column; gap: 2px;
}
/* Specific fix for White Mode Reply legibility */
[data-theme="white-matte"] .reply-context { background: rgba(0,0,0,0.05); }

.reply-sender { font-weight: 800; color: var(--accent-color); font-size: 0.7rem; margin-bottom: 0px; display: block; opacity: 1; }
.reply-text { color: var(--text-primary); opacity: 0.8; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: block; }

/* --- INPUT COCKPIT (Floating & Rounded) --- */
.chat-cockpit {
    position: absolute; 
    bottom: 20px; left: 20px; right: 20px; 
    z-index: 60;
    
    background: var(--cockpit-bg); 
    border: var(--panel-border);
    
    /* ROUNDED CORNERS */
    border-radius: 24px !important;
    
    padding: 12px 20px;
    display: flex; align-items: center; gap: 12px;
    
    /* Deep Shadow for Float Effect */
    box-shadow: var(--shadow-depth);
    backdrop-filter: var(--panel-blur);
}

.cockpit-actions { display: flex; gap: 10px; }
.float-icon {
    width: 40px; height: 40px; border-radius: 12px;
    border: 1px solid var(--text-secondary);
    display: flex; align-items: center; justify-content: center;
    color: var(--text-secondary); cursor: pointer; transition: all 0.2s;
    background: transparent;
    opacity: 0.7;
}
.float-icon:hover { color: var(--text-primary); border-color: var(--text-primary); opacity: 1; transform: translateY(-2px); }

.input-capsule {
    flex: 1; display: flex; align-items: center;
    background: var(--input-bg); 
    border-radius: 50px; padding: 4px 6px 4px 16px;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.05); 
}
.input-capsule:focus-within { border: 1px solid var(--accent-color); }

.chat-input { flex: 1; background: transparent; border: none; color: var(--text-primary); font-size: 0.95rem; padding: 8px 0; }
.chat-input:focus { outline: none; }

.send-orb { 
    width: 40px; height: 40px; border-radius: 50%; 
    background: var(--bubble-self-bg); 
    display: flex; align-items: center; justify-content: center; 
    color: white; border: none; cursor: pointer; 
    box-shadow: 0 4px 10px rgba(0,0,0,0.2); transition: 0.2s; 
}
.send-orb:hover { transform: scale(1.1); filter: brightness(1.1); }

/* --- MENU & DROPDOWN --- */
.menu-arrow { position: absolute; top: 6px; right: -25px; opacity: 0; cursor: pointer; color: var(--text-secondary); padding: 4px; transition: 0.2s; z-index: 20; }
.chat-bubble:hover .menu-arrow { opacity: 1; right: -30px; }
.chat-bubble.self .menu-arrow { right: auto; left: -25px; }
.chat-bubble.self:hover .menu-arrow { left: -30px; }

.msg-menu {
    opacity: 0; visibility: hidden; transform: translateY(-5px) scale(0.95); pointer-events: none;
    position: absolute; top: 0; z-index: 100;
    background: var(--menu-bg); border: 1px solid var(--text-secondary);
    border-radius: 10px; box-shadow: 0 5px 20px rgba(0,0,0,0.3);
    min-width: 120px; overflow: hidden; 
    transition: all 0.1s ease-out;
}
.msg-menu.active { opacity: 1; visibility: visible; transform: translateY(0) scale(1); pointer-events: auto; }
.chat-bubble.self .msg-menu { right: 100%; margin-right: 8px; } 
.chat-bubble.other .msg-menu { left: 100%; margin-left: 8px; }

.menu-item { padding: 8px 12px; font-size: 0.75rem; color: var(--text-primary); cursor: pointer; display: flex; align-items: center; gap: 8px; border-bottom: 1px solid rgba(255,255,255,0.05); }
.menu-item:last-child { border-bottom: none; }
.menu-item:hover { background: var(--menu-hover); }
.menu-item.danger { color: #f87171; }
.menu-icon { width: 12px; height: 12px; opacity: 0.7; }

/* --- OTHERS --- */
.meta-header { display: flex; align-items: center; justify-content: space-between; padding-bottom: 4px; border-bottom: 1px solid rgba(255,255,255,0.1); margin-bottom: 2px; padding-right: 20px; }
[data-theme="white-matte"] .meta-header { border-bottom-color: rgba(0,0,0,0.08); }

.user-info { display: flex; align-items: center; gap: 6px; flex-wrap: nowrap; }
.username-text { font-size: 0.75rem; font-weight: 800; color: var(--text-primary); }
.chat-bubble.self .username-text { color: white; } 
.chat-bubble.other .username-text { color: var(--accent-color); }

.hud-badge { font-size: 0.45rem; font-weight: 900; padding: 1px 5px; border-radius: 4px; border: 1px solid; background: rgba(0,0,0,0.2); text-transform: uppercase; display: flex; gap: 2px; align-items: center; color: var(--text-primary); border-color: var(--text-secondary); }
.chat-bubble.self .hud-badge { border-color: rgba(255,255,255,0.5); color: white; }
.hb-gold { border-color: #FFD700; color: #FFD700; } .hb-bronze { border-color: #cd7f32; color: #cd7f32; }

.msg-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 2px; height: 16px; }
.reaction-bar { display: flex; gap: 6px; }
.react-btn { display: flex; align-items: center; gap: 4px; font-size: 0.65rem; color: var(--text-secondary); cursor: pointer; padding: 2px 4px; border-radius: 8px; }
.react-btn:hover { background: rgba(255,255,255,0.1); color: var(--text-primary); }
.footer-meta { display: flex; align-items: center; gap: 3px; font-size: 0.55rem; opacity: 0.7; font-weight: 600; margin-left: auto; color: inherit; }
.read-check { width: 12px; height: 12px; }
.emoji-trigger { color: var(--text-secondary); cursor: pointer; padding: 8px; transition: 0.2s; }
.emoji-trigger:hover { color: var(--accent-color); transform: scale(1.1); }
#reply-banner { bottom: 80px; left: 20px; right: 20px; border-radius: 12px; border-left: 4px solid var(--accent-color); background: var(--panel-bg); backdrop-filter: blur(10px); color: var(--text-primary); }
.edit-wrapper { display: flex; align-items: center; gap: 6px; width: 100%; margin-top: 5px; }
.edit-input { flex: 1; background: rgba(0,0,0,0.1); border: 1px solid var(--text-secondary); border-radius: 8px; padding: 6px 10px; color: inherit; font-size: 0.9rem; }
.edit-btn { width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: bold; font-size: 0.8rem; }
.edit-save { background: rgba(34, 197, 94, 0.2); color: #4ade80; border: 1px solid #4ade80; }
.edit-cancel { background: rgba(239, 68, 68, 0.2); color: #f87171; border: 1px solid #f87171; }
.picker-container { width: 340px; height: 400px; background: var(--menu-bg); border: 1px solid var(--text-secondary); border-radius: 16px; position: absolute; bottom: 85px; right: 20px; z-index: 100; display: flex; flex-direction: column; box-shadow: 0 10px 40px rgba(0,0,0,0.3); overflow: hidden; }
.picker-tabs { display: flex; background: rgba(0,0,0,0.05); padding: 6px; gap: 4px; border-bottom: 1px solid var(--text-secondary); }
.ptab { flex: 1; text-align: center; padding: 8px; font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); cursor: pointer; border-radius: 6px; transition: 0.2s; }
.ptab.active { background: rgba(139, 92, 246, 0.1); color: var(--accent-color); }
.picker-grid { flex: 1; overflow-y: auto; padding: 12px; display: grid; gap: 8px; }
.g-emoji { grid-template-columns: repeat(7, 1fr); font-size: 1.5rem; }
.p-item { cursor: pointer; border-radius: 6px; display: flex; justify-content: center; align-items: center; transition: 0.2s; padding: 4px; }
.p-item:hover { background: rgba(255,255,255,0.1); transform: scale(1.1); }
/* Profile Utilities */
.glass-panel { background: var(--panel-bg); border: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(20px); border-radius: 24px; box-shadow: var(--shadow-depth); }
.btn-engineered { background: var(--bubble-self-bg); color: white; font-weight: 700; border-radius: 16px; padding: 12px 24px; box-shadow: 0 0 15px rgba(0,0,0,0.2); border: none; cursor: pointer; }
.input-engineered { background: var(--input-bg); border: 1px solid var(--text-secondary); color: var(--text-primary); border-radius: 12px; padding: 12px; width: 100%; }
.rank-badge { width: 48px; height: 48px; display: flex; align-items: center; justify-content: center; border-radius: 50%; background: var(--bg-main); border: 2px solid var(--text-secondary); color: var(--text-secondary); }